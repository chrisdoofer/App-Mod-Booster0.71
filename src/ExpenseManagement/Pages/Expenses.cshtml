@page
@model ExpensesModel
@{
    ViewData["Title"] = "View Expenses";
}

<div class="card">
    <h2>üìã All Expenses</h2>

    <form method="get" style="margin: 20px 0;">
        <div style="display: flex; gap: 15px; align-items: end;">
            <div class="form-group" style="flex: 1; margin-bottom: 0;">
                <label for="status">Filter by Status</label>
                <select class="form-control" id="status" name="status">
                    <option value="">All Statuses</option>
                    <option value="Submitted" selected="@(Model.StatusFilter == "Submitted")">Submitted</option>
                    <option value="Approved" selected="@(Model.StatusFilter == "Approved")">Approved</option>
                    <option value="Rejected" selected="@(Model.StatusFilter == "Rejected")">Rejected</option>
                    <option value="Draft" selected="@(Model.StatusFilter == "Draft")">Draft</option>
                </select>
            </div>

            <div class="form-group" style="flex: 1; margin-bottom: 0;">
                <label for="employeeName">Filter by Employee</label>
                <input type="text" class="form-control" id="employeeName" name="employeeName" value="@Model.EmployeeFilter" placeholder="Enter employee name" />
            </div>

            <button type="submit" class="btn btn-primary">üîç Filter</button>
        </div>
    </form>

    @if (Model.Expenses.Any())
    {
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Employee</th>
                    <th>Description</th>
                    <th>Amount</th>
                    <th>Category</th>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Reviewer</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var expense in Model.Expenses)
                {
                    <tr>
                        <td>@expense.ExpenseId</td>
                        <td>@expense.UserName</td>
                        <td>@expense.Description</td>
                        <td>¬£@expense.Amount.ToString("N2")</td>
                        <td>@expense.CategoryName</td>
                        <td>@expense.ExpenseDate.ToString("dd/MM/yyyy")</td>
                        <td>
                            <span style="padding: 5px 10px; border-radius: 4px; font-size: 0.9rem;
                                background: @(expense.StatusName == "Approved" ? "#d4edda" : expense.StatusName == "Rejected" ? "#f8d7da" : "#fff3cd");
                                color: @(expense.StatusName == "Approved" ? "#155724" : expense.StatusName == "Rejected" ? "#721c24" : "#856404");">
                                @expense.StatusName
                            </span>
                        </td>
                        <td>@(expense.ReviewerName ?? "-")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p style="margin-top: 20px; text-align: center; color: #6c757d;">No expenses found.</p>
    }
</div>
